:root{--primary: #1976d2;--success: #4caf50;--danger: #f44336;--warning: #ff9800;--bg: #f5f5f5;--border: #e0e0e0}*{box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background:var(--bg);margin:0;font-size:16px;line-height:1.5}.header{display:flex;align-items:center;gap:20px;padding:12px 24px;background:#fff;border-bottom:1px solid var(--border)}.header h1{margin:0;font-size:22px;color:var(--primary)}.header-title{color:inherit;text-decoration:none}.header-period{display:flex;align-items:center;gap:8px}.header-delete-period{padding:4px 8px;font-size:13px;color:var(--danger);background:transparent;border:1px solid var(--danger);border-radius:4px;cursor:pointer}.header-delete-period:hover:not(:disabled){background:var(--danger);color:#fff}.header-delete-period:disabled{opacity:.5;cursor:not-allowed}.header-refresh{padding:4px 8px;font-size:13px;color:var(--primary);background:transparent;border:1px solid var(--primary);border-radius:4px;cursor:pointer}.header-refresh:hover{background:var(--primary);color:#fff}.upload-progress{font-size:13px;color:#666;margin-left:8px}.header-delete-message{font-size:13px;color:var(--success)}.period-select{padding:6px 10px;border:1px solid var(--border);border-radius:4px;font-size:15px}.breadcrumb{padding:12px 24px;background:#fff;border-bottom:1px solid var(--border);font-size:15px}.breadcrumb a{color:var(--primary);text-decoration:none}.breadcrumb a:hover{text-decoration:underline}.breadcrumb-sep{color:#666}.breadcrumb-current{color:#333}.trend-panel{padding:16px 24px;margin:0 24px 16px;background:#fff;border:1px solid var(--border);border-radius:8px;font-size:1.05rem}.trend-panel-title{margin:0 0 12px;font-size:1.3rem;color:#333}.trend-panel-message{margin:0;color:#666;font-size:15px}.trend-panel-controls{margin-bottom:12px}.trend-metric-select{padding:6px 10px;border:1px solid var(--border);border-radius:4px;font-size:15px}.simple-chart{margin-top:8px}.simple-chart-empty{display:flex;align-items:center;justify-content:center;color:#888;font-size:15px}.dashboard-section{margin-bottom:24px}.dashboard-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-top:12px}@media (max-width: 720px){.dashboard-grid{grid-template-columns:1fr}}.dashboard-chart{background:#fafafa;border:1px solid var(--border);border-radius:6px;padding:12px;min-height:240px}.dashboard-chart-title{margin:0 0 8px;font-size:16px;font-weight:600;color:#333}.table-container{padding:24px}.search-input{padding:8px 12px;border:1px solid var(--border);border-radius:4px;width:300px;margin-bottom:16px;font-size:15px}.table{width:100%;border-collapse:collapse;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.table th{background:var(--primary);color:#fff;padding:12px 16px;text-align:left;cursor:pointer;-webkit-user-select:none;user-select:none;font-size:15px}.table th:hover{background:#1565c0}.table td{padding:12px 16px;border-bottom:1px solid var(--border);font-size:15px;line-height:1.4}.table tbody tr:hover{background:#e3f2fd}.table tr.clickable:hover{cursor:pointer}.table tbody tr:last-child td{border-bottom:none}.profit-positive{color:var(--success);font-weight:500}.profit-negative{color:var(--danger);font-weight:500}.pagination{display:flex;align-items:center;gap:8px;margin-top:16px}.pagination button{padding:6px 12px;border:1px solid var(--border);background:#fff;border-radius:4px;cursor:pointer;font-size:14px}.pagination button:hover:not(:disabled){background:#f5f5f5}.pagination button:disabled{opacity:.5;cursor:not-allowed}.btn{padding:8px 16px;border:none;border-radius:4px;cursor:pointer;font-size:15px}.btn-primary{background:var(--primary);color:#fff}.btn-primary:hover{background:#1565c0}.sheet-status{font-size:13px;padding:4px 8px;border-radius:4px}.sheet-status.ok{background:#e8f5e9;color:var(--success)}.sheet-status.error{background:#ffebee;color:var(--danger)}.page-actions{padding:16px 24px;background:#fff;border-bottom:1px solid var(--border)}.drilldown-panel{margin-top:16px}.drilldown-rail{display:flex;flex-direction:row;align-items:stretch;gap:20px;padding:12px 12px 16px;overflow-x:auto;overflow-y:hidden;min-height:280px;border:1px solid var(--border);border-radius:8px;background:#fafafa}.drill-rail{gap:20px;padding:12px 12px 16px;scroll-behavior:smooth}.drilldown-rail-column{display:flex;flex-direction:column;min-width:0;flex:1 1 auto;border-right:1px solid var(--border);background:#fff;overflow:hidden}.drilldown-rail-column:last-child{border-right:none}.rail-resizer{width:10px;flex:0 0 10px;cursor:col-resize;background:transparent;position:relative}.rail-resizer:before{content:"";position:absolute;top:8px;bottom:8px;left:50%;width:2px;transform:translate(-50%);background:#00000026;border-radius:2px}.rail-resizer:hover:before{background:#00000059}.drill-panel{flex:1 1 auto;background:#fff;border:1px solid #e5e5e5;border-radius:12px;box-shadow:0 2px 10px #0000000f;padding:0;min-height:200px;border-right:none;font-size:15px}.drill-panel.level-1,.drill-panel.level-2,.drill-panel.level-3,.drill-panel.level-4{width:100%}.drill-panel-header{position:sticky;top:0;z-index:2;background:#fff;border-bottom:1px solid #eee;padding:12px 14px;display:flex;align-items:center;justify-content:space-between;gap:12px}.drill-panel-title{font-size:17px;font-weight:600;line-height:1.3;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.drill-panel-body{padding:12px 14px 16px;overflow:auto;max-height:calc(100vh - 220px);width:100%}.drill-panel.inactive{opacity:.88}.drill-panel.active{opacity:1;box-shadow:0 6px 18px #0000001f}.drill-panel.enter{animation:drillEnter .2s ease-out}@keyframes drillEnter{0%{opacity:0;transform:translate(14px)}to{opacity:1;transform:translate(0)}}.drill-panel table{width:100%;border-collapse:separate;border-spacing:0}.drill-panel th,.drill-panel td{font-size:15px;padding:10px 12px;vertical-align:top;line-height:1.4}.drill-panel td.num,.drill-panel th.num{white-space:nowrap;text-align:right}.drill-panel td.label,.drill-panel th.label{white-space:normal;overflow-wrap:anywhere;word-break:break-word}.drill-panel .table-controls,.drill-panel .pagination{display:flex;gap:8px;flex-wrap:wrap}.drilldown-rail-column-header{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;padding:10px 12px;border-bottom:1px solid var(--border);background:#f5f5f5;font-size:15px;font-weight:600}.drill-panel-header.drilldown-rail-column-header{background:#fff;border-bottom:1px solid #eee}.drilldown-rail-column-header .drilldown-rail-close{padding:4px 10px;font-size:14px;border:1px solid var(--border);background:#fff;border-radius:4px;cursor:pointer}.drilldown-rail-column-header .drilldown-rail-close:hover{background:#eee}.drilldown-rail-column-body{flex:1;padding:12px;overflow-y:auto;overflow-x:auto}.drilldown-header-row{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;margin-bottom:12px}.drilldown-title{margin:0;font-size:18px;font-weight:600}.drilldown-close{padding:6px 12px;border:1px solid var(--border);background:#fff;border-radius:4px;cursor:pointer;font-size:14px}.drilldown-close:hover{background:#f5f5f5}.drilldown-tabs{display:flex;gap:4px;margin-bottom:12px}.drilldown-tab{padding:6px 12px;font-size:14px;border:1px solid var(--border);background:#fff;border-radius:4px;cursor:pointer;color:#555}.drilldown-tab:hover:not(.disabled){background:#f5f5f5}.drilldown-tab.active{background:var(--primary);color:#fff;border-color:var(--primary)}.drilldown-tab.disabled{opacity:.5;cursor:not-allowed}.drill-chart{margin-bottom:12px}.drilldown-summary{display:flex;flex-wrap:wrap;gap:16px;margin-bottom:12px;font-size:15px;color:#333}.top-n-row{display:flex;align-items:center;gap:12px;margin-bottom:12px}.top-n-row .top-n-select{padding:4px 8px;border:1px solid var(--border);border-radius:4px;font-size:15px}.grouped-bar-rows{margin-top:8px;font-size:15px;width:100%;min-width:100%}.grouped-bar-rows-empty{color:#666;padding:12px 0}.grouped-bar-row{display:flex;align-items:center;gap:12px;border-bottom:1px solid var(--border);min-height:56px}.grouped-bar-row-clickable:hover{background:#1976d20f}.grouped-bar-row-label{flex-shrink:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#333;min-width:180px}.drill-panel .grouped-bar-row-label{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;white-space:normal;overflow-wrap:anywhere;word-break:break-word;text-overflow:ellipsis;min-width:180px;font-size:15px;line-height:1.4}.drill-panel .grouped-bar-row:not(.grouped-bar-row-header){min-height:56px;height:auto;align-items:flex-start;padding-top:8px;padding-bottom:8px}.grouped-bar-row-chart{flex:1;min-width:320px}.bars-grid{display:grid;column-gap:12px;align-items:flex-end;min-width:0}.bars-grid.cols-1{grid-template-columns:1fr}.bars-grid.cols-2{grid-template-columns:1fr 1fr}.bars-grid.cols-3{grid-template-columns:1fr 1fr 1fr}.bar-cell{min-width:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-end}.grouped-bar-row-total-col.col-total{width:90px;max-width:90px;min-width:90px;text-align:right;white-space:nowrap;font-size:15px}.customer-drill-metrics-table .table tbody tr:last-child{font-weight:600;background:#0000000a}.service-cost-breakdown-table .table tbody tr:last-child td{font-weight:700;border-top:2px solid #ddd}.drilldown-rail{display:flex;width:100%;max-width:100%;overflow:hidden}.drilldown-rail-column.level-1{flex:1 1 0;min-width:340px}.drilldown-rail-column.level-2{flex:2 1 0;min-width:440px}.drilldown-rail-column.level-3{flex:1 1 auto}.rail-resizer{width:8px;cursor:col-resize;background:transparent;position:relative;flex:0 0 8px}.rail-resizer:before{content:"";position:absolute;left:3px;top:8px;bottom:8px;width:2px;border-radius:2px;background:#d0d0d0}.rail-resizer:hover:before{background:#9e9e9e}
